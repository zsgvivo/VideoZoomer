BOXED_SYSTEM_PROMPT="""You FIRST think about the reasoning process as an internal monologue and then provide the final answer.
 The reasoning process MUST BE enclosed within <think> </think> tags. The final answer MUST BE put in \boxed{}."""

MM_SYSTEM_PROMPT="""You FIRST think about the reasoning process step by step as an internal monologue and then provide the final answer.
 The reasoning process MUST BE enclosed within <think> </think> tags. The final answer MUST BE put in <answer> </answer> tags."""

SYSTEM_PROMPT_MAP={
    "multimodal": MM_SYSTEM_PROMPT,
    "boxed": BOXED_SYSTEM_PROMPT,
}

OPEN_ENDED_DATA_SOURCES = {'robut_sqa_8514_fixed', 'image_textualization_dataset_filtered', 'MathV360K_TabMWP_22462', 'websight_10000_fixed', 'geo3k_2101', 'MathV360K_GEOS_508', 'VisualWebInstruct_filtered_263589', 'atree_sft_accepted_data_287_with_tos_key_287', 'iam_5663_fixed', 'geo170k_qa_converted_67833', 'atree_generated_4k_accepted_data_11386_with_tos_key_11386_fixed_image_tags', 'train_augmented_20901_processed_with_tos_key_fix_roles_with_image_tag', 'accepted_data_11397_with_tos_key_11397', 'intergps_1280_llava_format_fixed', 'hateful_memes_8500_llava_format_fixed', 'tallyqa_98680_llava_format_fixed', 'sroie_data_33626_with_tos_key_33626', 'mmmu_sft_trial_accepted_data_2493_with_tos_key_2493', 'llava_cot_100k_with_tos_key_98582', 'tabmwp_22722_fixed', 'MathV360K_UniGeo_11959', 'mapqa_37417_llava_format_fixed', 'infographic_azuregpt4v_1992', 'ureader_kg_sft', 'alfredplpl_artbench-pd-256x256_processed_46298_with_tos_key', 'cambrian_filtered_gpt4vo_sp_token_fltd_max10k_checked', 'MathV360K_GeoQA+_17172', 'vision_oritented_qas_with_tos_key_fixed_14322', 'OmniDocBench_train_caption_prompt_sft_data_with_tos_key_979', 'infographic_vqa_2118_llava_format_fixed', 'ureader_cap_sft', 'train_human_7398_processed_with_tos_key_fix_roles_with_image_tag', 'dvqa_200000_llava_format_with_toskey', 'sft_tt_v2_313k_imgqa_enhanced_qa_with_image_tag', 'gen_sft_data_v1', 'geomverse_9303_with_toskey', 'llava_wild_4v_12k_filtered_15129', 'plotqa_157070_llava_format_with_tos_key_with_image_tag', 'ureader_qa_sft', 'MathV360K_VQA-AS_5907', 'latex_ocr_train_filtered_with_tos_keys_with_image_tag', 'invoices-and-receipts_ocr_v1_combined_5092', 'allava_instruct_vflan4v_20000', 'ureader_ie_sft', 'oroikon_chart_captioning_processed_7057_with_tos_key_with_image_tag', 'iiit5k_annotations_2000_with_tos_key_2000', 'MathV360K_Geometry3K_9734', 'geo170k_align_converted_60252', 'vision_flan_filtered_186070', 'visualmrc_3027_fixed', 'claude_3.5_sonnet_1022_2319_with_tos_key_2319', 'OCRVQA_train_with_tos_key_798067_with_conversations_798067_with_image_tag', 'laion_220k-GPT4Vision-captions-from-LIVIS_processed_217868_with_tos_key', 'MathV360K_VizWiz_6614', 'mavis_math_rule_geo_100000', 'MathV360K_CLEVR-Math_5290', 'robut_wikisql_74989_fixed', 'sharegpt4v-sam-20k', 'ai2d_azuregpt_detailed_understanding_4874', 'st_vqa_17247_llava_format_fixed', 'sft_tt_v1_499k_imgqa_enhanced_qa_with_image_tag', 'MathV360K_MapQA_5235', 'allenai_pixmo_docs_tables_processed_46518_with_tos_key_with_image_tag', 'mmmu_sft_cleaned_v2_accepted_data_5104_with_tos_key_5104', 'llava_next_fit_mix_filtered_text_wild_738590', 'MathV360K_FigureQA_17597', 'gen_caption_data_v2_2465_with_tos_key_2465', 'tqa_llava_format_27307_fixed', 'evqa_train_filtered_with_tos_keys_filtered_167349', 'mmmu_caption_reason_answer_final_self_correct_v2_with_tos_key_1171', 'screen2words_15730_fixed', 'visual7w_llava_format_14366_fixed', 'Wikipedia_2M_with_tos_key_2019163_filtered_2019159', 'sharegpt4o_dataset', 'textocr_gpt4v_train_converted_25114', 'textcaps_train_21952', 'hitab_2500_llava_format_fixed', 'allava_instruct_laion4v_50000', 'sharegpt4v-knowledge-2k', 'MathV360K_PMC-VQA_35958', 'lrv_normal_gpt4v_filtered_10497', 'allenai_pixmo_docs_charts_processed_116814_with_tos_key_with_image_tag', 'sft_tt_v1_499k_imgqa_score_explanation_with_image_tag_filtered_multihiertt', 'ureader_tr_processed_with_tos_key_fixed', 'diagram_image_to_text_300_fixed', 'ai2d_train_internvl_single_12413', 'ai2d_llava_format_2434_fixed', 'sharegpt4v-llava-30k', 'vistext_9969_fixed', 'MathV360K_PlotQA_5485', 'chartqa_18265_llava_format_fixed', 'visual_chat_en_26048_gpt4o_coco_checked', 'llavar_gpt4_20k', 'sft1p8m_enhanced_single_img_with_image_tags', 'sharegpt4v-coco-50k', 'MathV360K_TQA_10181', 'mavis_math_metagen_87358', 'vsr_2157_llava_format_fixed', 'gen_cap_v1_with_tos_key_2144', 'chart2text_26961_fixed', 'MathV360K_Super-CLEVR_8652', 'vqarad_313_llava_format_fixed', 'rootsautomation_websrc_train_processed_307315_fix_roles_with_image_tag', 'allenai_pixmo_docs_other_processed_71282_with_tos_key_with_image_tag', 'infographic_vqa_4404', 'arxivqa_train_filtered_with_tos_keys_with_image_tag', 'figureqa_100000_llava_format_with_toskey', 'datikz_1000_with_tos_key_1000', 'allenai_pixmo_docs_diagrams_processed_16551_with_tos_key_with_image_tag', 'hme100k_train_clean_74502_with_tos_key_74502', 'HuggingFaceM4_Docmatix_with_tos_key_single_565009_filtered_564972', 'llava_wild_4v_39k_filtered_39367', 'MathV360K_VQA-RAD_2130', 'sft_tt_v2_313k_imgqa_score_explanation_with_image_tag', 'rendered_text_10000_fixed', 'MathV360K_IconQA_22599', 'lrv_normal_gpt4v_filtered_10497', 'arxivqa_train_filtered_with_tos_keys_with_image_tag', 'mapqa_37417_llava_format_fixed', 'sft_tt_v1_499k_imgqa_score_explanation_with_image_tag_filtered_multihiertt', 'textocr_gpt4v_train_converted_25114', 'dvqa_200000_llava_format_with_toskey', 'vision_flan_filtered_186070', 'sft_tt_v1_499k_imgqa_enhanced_qa_with_image_tag', 'llava_cot_100k_with_tos_key_98582', 'ureader_cap_sft', 'sharegpt4v-llava-30k', 'llava_wild_4v_12k_filtered_15129', 'ureader_tr_processed_with_tos_key_fixed', 'latex_ocr_train_filtered_with_tos_keys_with_image_tag', 'mmmu_sft_trial_accepted_data_2493_with_tos_key_2493', 'mavis_math_rule_geo_100000', 'robut_wikisql_74989_fixed', 'sharegpt4o_dataset', 'plotqa_157070_llava_format_with_tos_key_with_image_tag', 'screen2words_15730_fixed', 'figureqa_100000_llava_format_with_toskey', 'sharegpt4v-coco-50k', 'OCRVQA_train_with_tos_key_798067_with_conversations_798067_with_image_tag', 'Wikipedia_2M_with_tos_key_2019163_filtered_2019159', 'image_textualization_dataset_filtered', 'ureader_kg_sft', 'sft_tt_v2_313k_imgqa_score_explanation_with_image_tag', 'allenai_pixmo_docs_other_processed_71282_with_tos_key_with_image_tag', 'laion_220k-GPT4Vision-captions-from-LIVIS_processed_217868_with_tos_key', 'chartqa_18265_llava_format_fixed', 'allava_instruct_laion4v_50000', 'allenai_pixmo_docs_tables_processed_46518_with_tos_key_with_image_tag', 'sft_tt_v2_313k_imgqa_enhanced_qa_with_image_tag', 'allenai_pixmo_docs_charts_processed_116814_with_tos_key_with_image_tag', 'atree_generated_4k_accepted_data_11386_with_tos_key_11386_fixed_image_tags', 'alfredplpl_artbench-pd-256x256_processed_46298_with_tos_key', 'VisualWebInstruct_filtered_263589', 'tallyqa_98680_llava_format_fixed', 'hme100k_train_clean_74502_with_tos_key_74502', 'HuggingFaceM4_Docmatix_with_tos_key_single_565009_filtered_564972', 'chart2text_26961_fixed', 'train_augmented_20901_processed_with_tos_key_fix_roles_with_image_tag', 'evqa_train_filtered_with_tos_keys_filtered_167349', 'llava_next_fit_mix_filtered_text_wild_738590', 'cambrian_filtered_gpt4vo_sp_token_fltd_max10k_checked', 'sft1p8m_enhanced_single_img_with_image_tags', 'sroie_data_33626_with_tos_key_33626', 'llava_wild_4v_39k_filtered_39367', 'st_vqa_17247_llava_format_fixed', 'ureader_qa_sft', 'megabench_filtered_max4_1746', 'mmmu_caption_max4_893', '20250115_general_data_v0_full_with_image', 'general_data_100shot_max_3_191601_cleaned', 'general_data_100shot_max_3_191601_cleaned'}

SELF_REFLECTIVE_INDICATORS = {"wait", "re-evaluate", "re-check", "double-check", "alternatively", "alternative", "hmm", "mistake", "hold on", "oh", "actually", "rethink", "pause", "reassess", "reverse", "verify", "undo", "again", "does that make sense", "does it make sense", "is this correct", "is that correct",}